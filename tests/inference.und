from si import @(metre, kilogram, second, Mass, Length, Time)

# ---
x = 5
y = x

# ---
a = 10
b = a + 5
c = b * 2

# ---
s = "hello"
t = s + " world"

# ---
m = 5 kilogram
n = m + 10 kilogram

# ---
d = 100 metre
e = d / 10

# ---
lst = [1, 2, 3]
first = lst[0]

# ---
words = ["a", "b", "c"]
word = words[1]

# ---
masses = [1 kilogram, 2 kilogram]
mass = masses[0]

empty = []
result = empty + [1, 2, 3]

# ---
base: List = []
extended = base + [5]

# ---
untyped = []
typed = untyped + [1 kilogram]

# ---
identity!(x) = x
result = identity(5)

# ---
double!(x) = x * 2
result = double(10)

# ---
add!(a, b) = a + b
sum = add(5, 10)

# ---
process!(x) = x + 5 kilogram
result = process(10 kilogram)

# ---
f!(x) = x * 2
g!(y) = f(y) + 3
result = g(5)

# ---
make_adder!(n) = !(x) = x + n
add_ten = make_adder(10)
result = add_ten(5)

# ---
poly!(x) = x * x
int_result = poly(5)

# ---
poly!(x) = x * x
mass_result = poly(5 kilogram)

either!(flag, a, b) = if flag then a else b
result = either(true, 5, 10)

either!(flag, a, b) = if flag then a else b
mass = either(false, 5 kilogram, 10 kilogram)

# ---
first_or_default!(lst, default) = if lst == [] then default else lst[0]
result = first_or_default([1, 2, 3], 0)

# ---
first_or_default!(lst: List[Int], default) = if lst == [] then default else lst[0]
result = first_or_default([], 5)

# ---
first_or_default!(lst: List[Int], default) = if lst == [] then default else lst[0]
mass = first_or_default([], 5 kilogram)

# ---
x = if true then 5 else 10
y = x + 3

# ---
m = if false then 5 kilogram else 10 kilogram
n = m * 2

# ---
if true then {
    temp = 5
    temp * 2
} else {
    temp = 10
    temp / 2
}

# ---
accumulator = 0
for i in [1, 2, 3] do {
    accumulator = accumulator + i
}

# ---
total = 0 kilogram
for m in [1 kilogram, 2 kilogram] do {
    total = total + m
}

# ---
result = []
for x in [1, 2, 3] do {
    result = result + [x * 2]
}

# ---
masses: List[Int] = []
for i in [1, 2, 3] do {
    masses = masses + [i]
    masses[i] -> kilogram
}

# ---
map!(f: ![[x: Int], Int], lst: List[Int]): List[Int] =
    if lst == [] then [] else [f(lst[0])] + map(f, lst[1:])
double!(x) = x * 2
result = map(double, [1, 2, 3])

# ---
fold!(f: ![[a: Int, b: Int], Int], acc: Int, lst: List[Int]): Int =
    if lst == [] then acc else fold(f, f(acc, lst[0]), lst[1:])
add!(a, b) = a + b
result = fold(add, 0, [1, 2, 3, 4, 5])

# ---
compose!(f, g) = !(x) = f(g(x))
add_one!(n) = n + 1
double!(n) = n * 2
combined = compose(double, add_one)
result = combined(5)

# ---
apply!(f, x) = f(x)
increment!(n) = n + 1
result = apply(increment, 10)

# ---
twice!(f, x) = f(f(x))
add_five!(n) = n + 5
result = twice(add_five, 10)

# ---
chain!(f, g, h) = !(x) = f(g(h(x)))
a!(n) = n + 1
b!(n) = n * 2
c!(n) = n - 3
combined = chain(a, b, c)
result = combined(10)

# ---
x = 5 + 3
y = x * 2
z = y / 4
result = z + 10

# ---
m = 10 kilogram
v = 5 metre/second
momentum = m * v
ke = (m * v^2) / 2

# ---
lst = [1, 2, 3]
doubled = lst * 2
first = doubled[0]
result = first + 10

# ---
nested = [[1, 2], [3, 4]]
inner = nested[0]
value = inner[1]
result = value * 3

# ---
func = !(x) = x * 2 + 5
result = func(10)

# E535
x = 5
x = "hello"
y = x + 10

# E535
m = 5 kilogram
m = 10 metre
n = m + 5 kilogram

# E521
x = if true then 5 else "hello"
y = x + 10

# E521
m = if true then 5 kilogram else 10 metre
n = m + 5 kilogram

# E525
lst = [1, "hello", 3]
first = lst[0]

# E525
mixed = [5, 10 kilogram]
value = mixed[0]

# E502
a = [1, 2]
b = ["x", "y"]
combined = a + b

# E703
add_wrong!(x) = x + 5 kilogram
add_wrong(10 metre)

# E703
process!(a, b) = a + b
process(5 kilogram, 10 metre)
